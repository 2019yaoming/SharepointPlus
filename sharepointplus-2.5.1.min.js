/**
 * Created by Aymeric
 * Contact: http://kodono.info
 * Documentation: http://aymkdn.github.com/SharepointPlus/
 * Licence: CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
 */
if(!Array.indexOf){Array.prototype.indexOf=function(b){for(var a=this.length-1;a>-1;a--){if(this[a]==b){return a}}return -1}}_SP_APPROVED=0;_SP_REJECTED=1;_SP_PENDING=2;_SP_DRAFT=3;_SP_SCHEDULED=4;(function(d){var a=function(g,p){var k=g.length;var q=new Array(k);var h=k/8;var o=k%8;for(var l=k-1;l>-1;l--){var j=h;var m=o;do{switch(m){case 0:q[l]=p(g[l]);l--;case 7:q[l]=p(g[l]);l--;case 6:q[l]=p(g[l]);l--;case 5:q[l]=p(g[l]);l--;case 4:q[l]=p(g[l]);l--;case 3:q[l]=p(g[l]);l--;case 2:q[l]=p(g[l]);l--;case 1:q[l]=p(g[l]);l--}m=0}while(--j>0)}return q};var f=function(l,h,m,i,j,k,g){h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(j=k=g="";m=l.charAt(g++);~m&&(i=k%4?i*64+m:m,k++%4)?j+=String.fromCharCode(255&i>>(-2*k&6)):0){m=h.indexOf(m)}return j};var b=function(h,g,l,k,j,i){g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";l="=";for(k=i="";j&=3,h.charAt(k++)||(g="=",j);i+=g.charAt(63&l>>++j*2)){l=l<<8|h.charCodeAt(k-=!j)}return i};var e={data:[],length:0,list:function(g){this.reset();this.listID=g;return this},parse:function(r){var h=r.replace(/(\s+)?(=|<=|>=|<>|<|>| LIKE | like )(\s+)?/g,"$2").replace(/""|''/g,"Null").replace(/==/g,"=");var l=[];var g=r.length;var n="",m="";var p="";var u={open:0};for(var w=0;w<h.length;w++){var z=h.charAt(w);switch(z){case"(":var k=w;var s=false;while(h.charAt(w)=="("&&w<g){w++;u.open++}while(u.open>0&&w<g){w++;var o=h.charAt(w);if(o=="'"){s=!s}else{if(o==")"&&!s){u.open--}}}var x=l.length-1;if(x>=0){if(n!=""){l[0]="<"+n+">"+l[0]}l[0]+=this.parse(h.substring(k+1,w));if(n!=""){l[0]+="</"+n+">"}n=""}else{l[0]=this.parse(h.substring(k+1,w))}break;case">":case"<":w++;if(h.charAt(w)=="="){l.push("<"+(z==">"?"G":"L")+"eq>");m="</"+(z==">"?"G":"L")+"eq>"}else{if(z=="<"&&h.charAt(w)==">"){l.push("<Neq>");m="</Neq>"}else{w--;l.push("<"+(z==">"?"G":"L")+"t>");m="</"+(z==">"?"G":"L")+"t>"}}break;case"=":l.push("<Eq>");m="</Eq>";break;case" ":if(h.substring(w,w+5).toUpperCase()==" AND "){n="And";w+=4}else{if(h.substring(w,w+4).toUpperCase()==" OR "){n="Or";w+=3}else{if(h.slice(w,w+6).toUpperCase()==" LIKE "){w+=5;l.push("<Contains>");m="</Contains>"}else{p+=z}}}break;case'"':case"'":var v=z;var y="";while((z=h.charAt(++w))!=v&&w<g){y+=z}x=l.length-1;l[x]+='<FieldRef Name="'+p+'" '+(y=="[Me]"?'LookupId="True" ':"")+"/>";p="";var j=(isNaN(y)?"Text":"Number");if(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/.test(y)||y=="[Today]"){j="DateTime"}y=this._cleanString(y);switch(y){case"[Today]":y='<Today OffsetDays="0" />';break;case"[Me]":y='<UserID Type="Integer" />';j="Integer";break}l[x]+='<Value Type="'+j+'">'+y+"</Value>";l[x]+=m;m="";if(x>0){if(n!=""){l[0]="<"+n+">"+l[0]}l[0]+=l[x];if(n!=""){l[0]+="</"+n+">"}delete (l[x]);n=""}break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(m!=""){var t=z;while(!isNaN(z=h.charAt(++w))&&w<g){t+=""+z}x=l.length-1;l[x]+='<FieldRef Name="'+p+'" />';p="";l[x]+='<Value Type="Number">'+t.replace(/ $/,"")+"</Value>";l[x]+=m;m="";if(x>0){if(n!=""){l[0]="<"+n+">"+l[0]}l[0]+=l[x];if(n!=""){l[0]+="</"+n+">"}delete (l[x]);n=""}w-=2;break}default:if(m==""){p+=z}else{if(z.toLowerCase()=="n"&&h.substring(w,w+4).toLowerCase()=="null"){x=l.length-1;if(m=="</Neq>"){l[x]="<IsNotNull>";m="</IsNotNull>"}else{if(m=="</Eq>"){l[x]="<IsNull>";m="</IsNull>"}}w+=3;l[x]+='<FieldRef Name="'+p+'" />';p="";l[x]+=m;m="";if(x>0){if(n!=""){l[0]="<"+n+">"+l[0]}l[0]+=l[x];if(n!=""){l[0]+="</"+n+">"}delete (l[x]);n=""}}}}}return l.join("")},_cleanString:function(g){return g.replace(/&(?!amp;|lt;|gt;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},get:function(n,h,p){switch(arguments.length){case 0:if(this.listID==undefined){throw"Error 'get': you have to define the list ID"}break;case 1:if(typeof n=="object"){return this.get(this.listID,n)}else{if(typeof n=="function"){return this.get(this.listID,{},n)}}case 2:if(typeof n=="string"&&typeof h=="function"){return this.get(n,{},h)}else{if(typeof n=="object"&&typeof h=="function"){return this.get(this.listID,n,h)}}case 3:this.listID=n}h=h||{};if(h.url==undefined&&typeof L_Menu_BaseUrl=="undefined"){throw"Error 'get': not able to find the URL!"}h.url=h.url||(d.location.protocol+"//"+d.location.host+L_Menu_BaseUrl);h.fields=h.fields||"";h.where=h.where||"";h.orderby=h.orderby||"";h.groupby=h.groupby||"";h.rowlimit=h.rowlimit||0;var v=(h.groupby!=""||/\[Me\]|\[Today\]/.test(h.where)||h.forceOWS===true||typeof SP=="object");this.fields="";if(h.fields==""||h.fields==[]){this.fields="<AllFields />"}else{if(typeof h.fields=="string"){h.fields=h.fields.replace(/ /g,"").split(",")}if(h.fields.indexOf("Attachments")!=-1){v=true}for(var j=0;j<h.fields.length;j++){this.fields+="<Field"+(v?"Ref":"")+' Name="'+h.fields[j]+'" />'}}var o="";if(h.orderby!=""){var u=h.orderby.split(",");for(j=0;j<u.length;j++){var t="ASC";var q=jQuery.trim(u[j]).split(" ");if(q.length>0){if(q.length==2){t=q[1].toUpperCase()}o+=(v?'<FieldRef Name="'+q[0]+'" Ascending="'+(t=="ASC")+'" />':'<OrderField Name="'+q[0]+'" Direction="'+t+'" />')}}}var s="";if(h.groupby!=""){var l=h.groupby.split(",");for(j=0;j<l.length;j++){s+='<FieldRef Name="'+l[j]+'" />'}}var k="";var r=[];if(v){k='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+this.listID+"</listName><viewName></viewName><query> <Query> "+(h.where!=""?"<Where>"+this.parse(h.where)+"</Where>":"")+" "+(s!=""?"<GroupBy>"+s+"</GroupBy>":"")+" "+(o!=""?"<OrderBy>"+o+"</OrderBy>":"")+" </Query> </query> <viewFields> <ViewFields> "+this.fields+" </ViewFields> </viewFields> <rowLimit>"+h.rowlimit+'</rowLimit> <queryOptions> <QueryOptions> <ViewAttributes Scope="Recursive"></ViewAttributes> <IncludeAttachmentUrls>True</IncludeAttachmentUrls> </QueryOptions> </queryOptions> </GetListItems></soap:Body></soap:Envelope>';var g=h.url+"/_vti_bin/Lists.asmx";var m=this;jQuery.ajax({type:"POST",cache:false,async:(p!=undefined?true:false),url:g,data:k,contentType:"text/xml; charset=utf-8",dataType:"xml",success:function(i){r=a(i.getElementsByTagName("z:row"),function(w){return c(w)});if(typeof p=="function"){p(r)}}})}else{k='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"> <soap:Header xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"> <dsp:versions xmlns:dsp="http://schemas.microsoft.com/sharepoint/dsp"> <dsp:version>1.0</dsp:version> </dsp:versions> <dsp:request xmlns:dsp="http://schemas.microsoft.com/sharepoint/dsp" service="DspSts" document="content" method="query"> </dsp:request> </soap:Header><soap:Body><queryRequest  xmlns="http://schemas.microsoft.com/sharepoint/dsp"> <dsQuery select="/list[@id=\''+this.listID+'\']" resultContent="dataOnly" columnMapping="attribute" resultRoot="Rows" resultRow="Row"> <Query RowLimit="'+(h.rowlimit>0?h.rowlimit:-1)+'"> <Fields>'+this.fields+"</Fields> <Where>"+this.parse(h.where)+"</Where> "+(s!=""?"<GroupBy>"+s+"</GroupBy>":"")+" "+(o!=""?"<OrderBy>"+o+"</OrderBy>":"")+" </Query> </dsQuery> </queryRequest></soap:Body></soap:Envelope>";var g=h.url+"/_vti_bin/dspsts.asmx";jQuery.ajax({type:"POST",cache:false,async:(p!=undefined?true:false),url:g,data:k,contentType:"text/xml; charset=utf-8",beforeSend:function(i){i.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/dsp/queryRequest")},dataType:"xml",success:function(i){if(typeof p=="function"){p(i.getElementsByTagName("Row"))}else{r=i.getElementsByTagName("Row")}}})}if(typeof p=="undefined"){this.data=r;this.length=this.data.length}return this},createFile:function(g){g=g||{};if(g.content==undefined){throw"Error 'createFile': not able to find the file content."}if(g.destination==undefined){throw"Error 'createFile': not able to find the file destination path."}if(g.url==undefined&&typeof L_Menu_BaseUrl=="undefined"){throw"Error 'createFile': not able to find the URL!"}g.url=g.url||(d.location.protocol+"//"+d.location.host+L_Menu_BaseUrl);g.after=g.after||(function(){});var h='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><CopyIntoItems xmlns="http://schemas.microsoft.com/sharepoint/soap/"><SourceUrl>http://null</SourceUrl><DestinationUrls><string>'+g.destination+"</string></DestinationUrls><Fields><FieldInformation Type='File' /></Fields><Stream>"+b(g.content)+"</Stream></CopyIntoItems></soap:Body></soap:Envelope>";jQuery.ajax({url:g.url+"/_vti_bin/copy.asmx",type:"POST",dataType:"xml",data:h,beforeSend:function(i){i.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/CopyIntoItems")},contentType:'text/xml; charset="utf-8"',success:function(j){var i=j.getElementsByTagName("CopyResult");if(i&&i[0]&&i[0].getAttribute("ErrorCode")!="Success"){throw"Error 'createFile': "+i[0].getAttribute("ErrorCode")+" - "+i[0].getAttribute("ErrorMessage")}if(typeof g.after=="function"){g.after()}}})},getAttachment:function(l,m,h,k){switch(arguments.length){case 0:if(this.listID==undefined){throw"Error 'getAttachment': you have to define the list ID"}else{throw"Error 'getAttachment': you have to define the item ID"}break;case 1:if(this.listID==undefined){throw"Error 'getAttachment': you have to define the list ID"}else{if(jQuery.type(l)=="string"){return this.getAttachment(this.listID,l)}else{throw"Error 'getAttachment': you have to define the item ID"}}break;case 2:if(jQuery.type(l)=="string"&&jQuery.type(m)=="function"){return this.getAttachment(this.listID,l,{},m)}else{if(jQuery.type(l)=="string"&&jQuery.type(m)=="object"){return this.getAttachment(this.listID,l,m)}}break;case 3:if(jQuery.type(h)=="function"&&jQuery.type(m)=="object"){return this.getAttachment(this.listID,l,m,h)}else{if(jQuery.type(h)=="function"){return this.getAttachment(l,m,{},h)}}break;case 4:this.listID=l}h=h||{};if(h.url==undefined&&typeof L_Menu_BaseUrl=="undefined"){throw"Error 'getAttachment': not able to find the URL!"}h.url=h.url||(d.location.protocol+"//"+d.location.host+L_Menu_BaseUrl);var g='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"> <soap:Body> <GetAttachmentCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/"> <listName>'+this.listID+"</listName> <listItemID>"+m+"</listItemID> </GetAttachmentCollection> </soap:Body></soap:Envelope>";var j=h.url+"/_vti_bin/lists.asmx";var i=[];jQuery.ajax({type:"POST",cache:false,async:(k!=undefined?true:false),url:j,data:g,contentType:"text/xml; charset=utf-8",beforeSend:function(n){n.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetAttachmentCollection")},dataType:"xml",success:function(p){var n=p.getElementsByTagName("Attachment");for(var o=0;o<n.length;o++){i.push(n[o].firstChild.nodeValue)}if(typeof k=="function"){k(i)}}});if(typeof k=="undefined"){this.data=i;this.length=this.data.length}return this},info:function(l,h,k){switch(arguments.length){case 0:if(this.listID==undefined){throw"Error 'info': you have to define the list ID"}break;case 1:if(typeof l=="object"){return this.info(this.listID,l)}else{if(typeof l=="function"){return this.info(this.listID,{},l)}}case 2:if(typeof l=="string"&&typeof h=="function"){return this.info(l,{},h)}else{if(typeof l=="object"&&typeof h=="function"){return this.info(this.listID,l,h)}}case 3:this.listID=l}h=h||{};if(h.url==undefined&&typeof L_Menu_BaseUrl=="undefined"){throw"Error 'info': not able to find the URL!"}h.url=h.url||(d.location.protocol+"//"+d.location.host+L_Menu_BaseUrl);var g='<?xml version="1.0" encoding="utf-8"?>';g+='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">';g+="  <soap:Body>";g+='    <GetList xmlns="http://schemas.microsoft.com/sharepoint/soap/">';g+="      <listName>"+this.listID+"</listName>";g+="    </GetList>";g+="  </soap:Body>";g+="</soap:Envelope>";var j=h.url+"/_vti_bin/lists.asmx";var i=[];jQuery.ajax({type:"POST",cache:false,async:(k!=undefined?true:false),url:j,data:g,contentType:"text/xml; charset=utf-8",beforeSend:function(m){m.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetList")},dataType:"xml",success:function(t){var m=t.getElementsByTagName("Field");var p=0;for(var q=0;q<m.length;q++){if(m[q].getAttribute("ID")){i[p]=[];i[p]["Description"]=m[q].getAttribute("Description");i[p]["StaticName"]=m[q].getAttribute("StaticName");i[p]["DisplayName"]=m[q].getAttribute("DisplayName");i[p]["Format"]=m[q].getAttribute("Format");i[p]["SourceID"]=m[q].getAttribute("SourceID");i[p]["Required"]=m[q].getAttribute("Required");i[p]["Type"]=m[q].getAttribute("Type");if(i[p]["Type"]=="Choice"){var n=m[q].getElementsByTagName("CHOICE");var s=[];for(var o=0;o<n.length;o++){s.push(n[o].firstChild.nodeValue)}i[p]["Choices"]=s}else{i[p]["Choices"]=[]}i[p]["DefaultValue"]=(m[q].getElementsByTagName("Default").length>0?m[q].getElementsByTagName("Default")[0].nodeValue:"");p++}}if(typeof k=="function"){k(i)}}});if(typeof k=="undefined"){this.data=i;this.length=this.data.length}return this},view:function(l,m,h,k){switch(arguments.length){case 0:if(this.listID==undefined){throw"Error 'view': you have to define the list ID"}break;case 1:if(typeof l=="string"){return this.view(this.listID,l)}else{if(typeof l=="function"){return this.view(this.listID,"",{},l)}}case 2:if(typeof l=="string"&&typeof m=="object"){return this.view(this.listID,l,m)}else{if(typeof l=="string"&&typeof m=="function"){return this.view(this.listID,l,{},m)}}case 3:if(typeof m=="string"&&typeof h=="function"){return this.view(this.listID,l,{},h)}case 4:this.listID=l}h=h||{};if(h.url==undefined&&typeof L_Menu_BaseUrl=="undefined"){throw"Error 'view': not able to find the URL!"}h.url=h.url||(d.location.protocol+"//"+d.location.host+L_Menu_BaseUrl);m=m||"";var g='<?xml version="1.0" encoding="utf-8"?>';g+='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">';g+="  <soap:Body>";g+='    <GetView xmlns="http://schemas.microsoft.com/sharepoint/soap/">';g+="      <listName>"+this.listID+"</listName>";g+="      <viewName>"+m+"</viewName>";g+="    </GetView>";g+="  </soap:Body>";g+="</soap:Envelope>";var j=h.url+"/_vti_bin/Views.asmx";var i=[];jQuery.ajax({type:"POST",cache:false,async:(k!=undefined?true:false),url:j,data:g,contentType:"text/xml; charset=utf-8",beforeSend:function(n){n.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetView")},dataType:"xml",success:function(p){var n=p.getElementsByTagName("ViewFields")[0].getElementsByTagName("FieldRef");for(var o=0;o<n.length;o++){i.push(n[o].getAttribute("Name"))}if(typeof k=="function"){k(i)}}});if(typeof k=="undefined"){this.data=i;this.length=this.data.length}return this},views:function(l,h,k){switch(arguments.length){case 0:if(this.listID==undefined){throw"Error 'views': you have to define the list ID"}break;case 1:if(typeof l=="object"){return this.views(this.listID,l)}else{if(typeof l=="function"){return this.views(this.listID,{},l)}}case 2:if(typeof l=="string"&&typeof h=="function"){return this.views(l,{},h)}else{if(typeof l=="object"&&typeof h=="function"){return this.views(this.listID,l,h)}}case 3:this.listID=l}h=h||{};if(h.url==undefined&&typeof L_Menu_BaseUrl=="undefined"){throw"Error 'views': not able to find the URL!"}h.url=h.url||(d.location.protocol+"//"+d.location.host+L_Menu_BaseUrl);var g='<?xml version="1.0" encoding="utf-8"?>';g+='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">';g+="  <soap:Body>";g+='    <GetViewCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/">';g+="      <listName>"+this.listID+"</listName>";g+="    </GetViewCollection>";g+="  </soap:Body>";g+="</soap:Envelope>";var j=h.url+"/_vti_bin/Views.asmx";var i=[];jQuery.ajax({type:"POST",cache:false,async:(k!=undefined?true:false),url:j,data:g,contentType:"text/xml; charset=utf-8",beforeSend:function(m){m.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetViewCollection")},dataType:"xml",success:function(o){var m=o.getElementsByTagName("View");for(var n=0;n<m.length;n++){i[n]=[];i[n]["ID"]=m[n].getAttribute("Name");i[n]["Name"]=m[n].getAttribute("DisplayName");i[n]["Url"]=m[n].getAttribute("Url")}if(typeof k=="function"){k(i)}}});if(typeof k=="undefined"){this.data=i;this.length=this.data.length}return this},lists:function(h,k){switch(arguments.length){case 1:if(typeof h=="function"){return this.lists({},h)}}h=h||{};if(h.url==undefined&&typeof L_Menu_BaseUrl=="undefined"){throw"Error 'lists': not able to find the URL!"}h.url=h.url||(d.location.protocol+"//"+d.location.host+L_Menu_BaseUrl);var g='<?xml version="1.0" encoding="utf-8"?>';g+='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">';g+="  <soap:Body>";g+='    <GetListCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/">';g+="    </GetListCollection>";g+="  </soap:Body>";g+="</soap:Envelope>";var j=h.url+"/_vti_bin/lists.asmx";var i=[];jQuery.ajax({type:"POST",cache:false,async:(k!=undefined?true:false),url:j,data:g,contentType:"text/xml; charset=utf-8",beforeSend:function(l){l.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/GetListCollection")},dataType:"xml",success:function(n){var l=n.getElementsByTagName("List");for(var m=0;m<l.length;m++){i[m]=[];i[m]["ID"]=l[m].getAttribute("ID");i[m]["Name"]=l[m].getAttribute("Title");i[m]["Url"]=l[m].getAttribute("DefaultViewUrl");i[m]["Description"]=l[m].getAttribute("Description")}if(typeof k=="function"){k(i)}}});if(typeof k=="undefined"){this.data=i;this.length=this.data.length}return this},each:function(g,h){switch(arguments.length){case 0:throw"Error 'each': you have to provide a function.";break;case 1:if(typeof g=="function"){jQuery.each(this.data,g)}else{throw"Error 'each': you have to provide a function."}break;default:if(jQuery.type(g)==="array"&&jQuery.type(h)==="function"){jQuery.each(g,h)}break}},add:function(m,o,h){switch(arguments.length){case 0:if(this.listID==undefined){throw"Error 'add': you have to define the list ID."}break;case 1:if(jQuery.type(m)==="string"){throw"Error 'add': you have to define the items to add."}else{if(jQuery.type(m)==="object"||jQuery.type(m)==="array"){return this.add(this.listID,m)}}case 2:if(jQuery.type(m)==="string"&&(jQuery.type(o)==="object"||jQuery.type(o)==="array")){break}if((jQuery.type(m)==="object"||jQuery.type(m)==="array")&&jQuery.type(o)==="object"){return this.add(this.listID,m,o)}case 3:this.listID=m}h=h||{};if(h.url==undefined&&typeof L_Menu_BaseUrl=="undefined"){throw"Error 'add': not able to find the URL!"}h.url=h.url||(d.location.protocol+"//"+d.location.host+L_Menu_BaseUrl);h.async=(h.async==undefined)?true:h.async;h.success=h.success||(function(){});h.error=h.error||(function(){});h.after=h.after||(function(){});h.escapeChar=(h.escapeChar==undefined)?true:h.escapeChar;h.progress=h.progress||(function(){});if(jQuery.type(o)=="object"){o=[o]}var s=o.length;h.progressVar=h.progressVar||{current:0,max:s,passed:[],failed:[],eventID:"spAdd"+(""+Math.random()).slice(2)};if(s>15){var p=o.slice(0);var q=p.splice(0,15);var l=this;$(document).on(h.progressVar.eventID,function(i){$(document).off(h.progressVar.eventID);l.add(p,i.setup)});this.add(q,h);return this}else{if(s==0){throw"'add': nothing to add!"}}h.progressVar.current+=s;var r='<Batch OnError="Continue" ListVersion="1"  ViewName="">';var n=this;for(var j=0;j<o.length;j++){r+='<Method ID="'+(j+1)+'" Cmd="New">';r+="<Field Name='ID'>New</Field>";jQuery.each(o[j],function(i,t){if(jQuery.type(t)=="array"){t=";#"+t.join(";#")+";#"}if(h.escapeChar&&jQuery.type(t)=="string"){t=n._cleanString(t)}r+="<Field Name='"+i+"'>"+t+"</Field>"});r+="</Method>"}r+="</Batch>";var k='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+this.listID+"</listName><updates>"+r+"</updates></UpdateListItems></soap:Body></soap:Envelope>";var g=h.url+"/_vti_bin/lists.asmx";jQuery.ajax({type:"POST",cache:false,async:h.async,url:g,data:k,beforeSend:function(i){i.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems")},contentType:"text/xml; charset=utf-8",dataType:"xml",success:function(x){var u=x.getElementsByTagName("Result");var t=u.length;var y=h.progressVar.passed,v=h.progressVar.failed;for(var w=0;w<t;w++){if(u[w].getElementsByTagName("ErrorCode")[0].firstChild.nodeValue=="0x00000000"){o[w].ID=u[w].getElementsByTagName("z:row")[0].getAttribute("ows_ID");y.push(o[w])}else{o[w].errorMessage=u[w].getElementsByTagName("ErrorText")[0].firstChild.nodeValue;v.push(o[w])}}h.progress(h.progressVar.current,h.progressVar.max);if(h.progressVar.current<h.progressVar.max){$(document).trigger({type:h.progressVar.eventID,setup:h})}else{if(y.length>0){h.success(y)}if(v.length>0){h.error(v)}h.after()}}});return this},update:function(m,o,h){switch(arguments.length){case 0:if(this.listID==undefined){throw"Error 'update': you have to define the list ID."}break;case 1:if(jQuery.type(m)==="string"){throw"Error 'update': you have to define the items to update."}else{if(jQuery.type(m)==="object"||jQuery.type(m)==="array"){return this.update(this.listID,m)}}case 2:if(jQuery.type(m)==="string"&&(jQuery.type(o)==="object"||jQuery.type(o)==="array")){break}if((jQuery.type(m)==="object"||jQuery.type(m)==="array")&&jQuery.type(o)==="object"){return this.update(this.listID,m,o)}case 3:this.listID=m}h=h||{};if(h.url==undefined&&typeof L_Menu_BaseUrl=="undefined"){throw"Error 'update': not able to find the URL!"}h.url=h.url||(d.location.protocol+"//"+d.location.host+L_Menu_BaseUrl);h.async=(h.async==undefined)?true:h.async;h.where=h.where||"";h.success=h.success||(function(){});h.error=h.error||(function(){});h.after=h.after||(function(){});h.escapeChar=(h.escapeChar==undefined)?true:h.escapeChar;h.progress=h.progress||(function(){});if(jQuery.type(o)=="object"){o=[o]}var s=o.length;if(s==1&&h.where){delete o[0].ID;var l=this;this.get({fields:"ID",where:h.where,url:h.url},function(w){var x=function(z){var y={};for(var i in z){y[i]=z[i]}return y};var t=[];for(var u=w.length;u--;){var v=x(o[0]);v.ID=w[u].getAttribute("ID");t.push(v)}delete h.where;l.update(t,h)});return this}h.progressVar=h.progressVar||{current:0,max:s,passed:[],failed:[],eventID:"spUpdate"+(""+Math.random()).slice(2)};if(s>15){var p=o.slice(0);var q=p.splice(0,15);var l=this;$(document).on(h.progressVar.eventID,function(i){$(document).off(h.progressVar.eventID);l.update(p,i.setup)});this.update(q,h);return this}else{if(s==0){throw"'update': nothing to update!"}}h.progressVar.current+=s;var r='<Batch OnError="Continue" ListVersion="1"  ViewName="">';var n=this;for(var j=0;j<s;j++){r+='<Method ID="'+(j+1)+'" Cmd="Update">';if(o[j].ID==undefined){throw"Error 'update': you have to provide the item ID called 'ID'"}jQuery.each(o[j],function(i,t){if(jQuery.type(t)=="array"){t=";#"+t.join(";#")+";#"}if(h.escapeChar&&jQuery.type(t)=="string"){t=n._cleanString(t)}r+="<Field Name='"+i+"'>"+t+"</Field>"});r+="</Method>"}r+="</Batch>";var k='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+this.listID+"</listName><updates>"+r+"</updates></UpdateListItems></soap:Body></soap:Envelope>";var g=h.url+"/_vti_bin/lists.asmx";jQuery.ajax({type:"POST",cache:false,async:h.async,url:g,data:k,beforeSend:function(i){i.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems")},contentType:"text/xml; charset=utf-8",dataType:"xml",success:function(x){var u=x.getElementsByTagName("Result");var t=u.length;var y=h.progressVar.passed,v=h.progressVar.failed;for(var w=0;w<t;w++){if(u[w].getElementsByTagName("ErrorCode")[0].firstChild.nodeValue=="0x00000000"){y.push(o[w])}else{o[w].errorMessage=u[w].getElementsByTagName("ErrorText")[0].firstChild.nodeValue;v.push(o[w])}}h.progress(h.progressVar.current,h.progressVar.max);if(h.progressVar.current<h.progressVar.max){$(document).trigger({type:h.progressVar.eventID,setup:h})}else{if(y.length>0){h.success(y)}if(v.length>0){h.error(v)}h.after()}}});return this},moderate:function(l,m,h){switch(arguments.length){case 0:if(this.listID==undefined){throw"Error 'moderate': you have to define the list ID."}break;case 1:if(jQuery.type(l)==="string"){throw"Error 'moderate': you have to define the items to moderate."}else{if(jQuery.type(l)==="object"||jQuery.type(l)==="array"){return this.moderate(this.listID,l)}}case 2:if(jQuery.type(l)==="string"&&(jQuery.type(m)==="object"||jQuery.type(m)==="array")){break}if((jQuery.type(l)==="object"||jQuery.type(l)==="array")&&jQuery.type(m)==="object"){return this.moderate(this.listID,l,m)}case 3:this.listID=l}h=h||{};if(h.url==undefined&&typeof L_Menu_BaseUrl=="undefined"){throw"Error 'moderate': not able to find the URL!"}h.url=h.url||(d.location.protocol+"//"+d.location.host+L_Menu_BaseUrl);h.async=(h.async==undefined)?true:h.async;h.success=h.success||(function(){});h.error=h.error||(function(){});h.after=h.after||(function(){});if(jQuery.type(m)=="object"){m=[m]}while(m.length>15){var n=m.slice(0,15);m.splice(0,15);this.moderate(l,n,h)}var p='<Batch OnError="Continue" ListVersion="1"  ViewName="">';var o=this;for(var j=0;j<m.length;j++){p+='<Method ID="'+(j+1)+'" Cmd="Moderate">';if(m[j].ID==undefined){throw"Error 'moderate': you have to provide the item ID called 'ID'"}else{if(m[j].ApprovalStatus==undefined){throw"Error 'moderate': you have to provide the approval status 'ApprovalStatus' (Approved, Rejected, Pending, Draft or Scheduled)"}}jQuery.each(m[j],function(i,q){if(i=="ApprovalStatus"){i="_ModerationStatus";switch(q){case"Approved":q=0;break;case"Rejected":q=1;break;case"Pending":q=2;break;case"Draft":q=3;break;case"Scheduled":q=4;break;default:q=2;break}}p+="<Field Name='"+i+"'>"+q+"</Field>"});p+="</Method>"}p+="</Batch>";var k='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+this.listID+"</listName><updates>"+p+"</updates></UpdateListItems></soap:Body></soap:Envelope>";var g=h.url+"/_vti_bin/lists.asmx";jQuery.ajax({type:"POST",cache:false,async:h.async,url:g,data:k,beforeSend:function(i){i.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems")},contentType:"text/xml; charset=utf-8",dataType:"xml",success:function(v){var r=v.getElementsByTagName("Result");var q=r.length;var w=[],s=[];for(var t=0;t<q;t++){var u=c(r[t].getElementsByTagName("z:row")[0]);if(r[t].getElementsByTagName("ErrorCode")[0].firstChild.nodeValue=="0x00000000"){w.push(u)}else{m[t].errorMessage=r[t].getElementsByTagName("ErrorText")[0].firstChild.nodeValue;s.push(m[t])}}if(w.length>0){h.success(w)}if(s.length>0){h.error(s)}h.after()}});return this},remove:function(m,n,h){switch(arguments.length){case 0:if(this.listID==undefined){throw"Error 'remove': you have to define the list ID."}break;case 1:if(jQuery.type(m)==="string"){throw"Error 'remove': you have to define the items to remove."}else{if(jQuery.type(m)==="object"||jQuery.type(m)==="array"){return this.remove(this.listID,m)}}case 2:if(jQuery.type(m)==="string"&&(jQuery.type(n)==="object"||jQuery.type(n)==="array")){break}if((jQuery.type(m)==="object"||jQuery.type(m)==="array")&&jQuery.type(n)==="object"){return this.remove(this.listID,m,n)}case 3:this.listID=m}if(!h&&n.where){h=n;n=[]}h=h||{};if(h.url==undefined&&typeof L_Menu_BaseUrl=="undefined"){throw"Error 'remove': not able to find the URL!"}h.url=h.url||(d.location.protocol+"//"+d.location.host+L_Menu_BaseUrl);h.async=(h.async==undefined)?true:h.async;h.success=h.success||(function(){});h.error=h.error||(function(){});h.after=h.after||(function(){});h.progress=h.progress||(function(){});if(jQuery.type(n)=="object"){n=[n]}var r=n.length;if(h.where){if(r==1){delete n[0].ID}var l=this;this.get({fields:"ID",where:h.where,url:h.url},function(v){var w=function(y){var x={};for(var i in y){x[i]=y[i]}return x};var s=[];for(var t=v.length;t--;){var u=w(n[0]);u.ID=v[t].getAttribute("ID");s.push(u)}delete h.where;l.remove(s,h)});return this}else{if(r==0){throw"'remove': nothing to delete!"}}h.progressVar=h.progressVar||{current:0,max:r,passed:[],failed:[],eventID:"spRemove"+(""+Math.random()).slice(2)};if(r>15){var o=n.slice(0);var p=o.splice(0,15);var l=this;$(document).on(h.progressVar.eventID,function(i){$(document).off(h.progressVar.eventID);l.remove(o,i.setup)});this.remove(p,h);return this}h.progressVar.current+=r;var q='<Batch OnError="Continue" ListVersion="1"  ViewName="">';for(var j=0;j<n.length;j++){q+='<Method ID="'+(j+1)+'" Cmd="Delete">';if(n[j].ID==undefined){throw"Error 'delete': you have to provide the item ID called 'ID'"}q+="<Field Name='ID'>"+n[j].ID+"</Field>";q+="</Method>"}q+="</Batch>";var k='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+this.listID+"</listName><updates>"+q+"</updates></UpdateListItems></soap:Body></soap:Envelope>";var g=h.url+"/_vti_bin/lists.asmx";jQuery.ajax({type:"POST",cache:false,async:h.async,url:g,data:k,beforeSend:function(i){i.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems")},contentType:"text/xml; charset=utf-8",dataType:"xml",success:function(w){var t=w.getElementsByTagName("Result");var s=t.length;var x=h.progressVar.passed,u=h.progressVar.failed;for(var v=0;v<s;v++){if(t[v].getElementsByTagName("ErrorCode")[0].firstChild.nodeValue=="0x00000000"){x.push(n[v])}else{n[v].errorMessage=t[v].getElementsByTagName("ErrorText")[0].firstChild.nodeValue;u.push(n[v])}}h.progress(h.progressVar.current,h.progressVar.max);if(h.progressVar.current<h.progressVar.max){$(document).trigger({type:h.progressVar.eventID,setup:h})}else{if(x.length>0){h.success(x)}if(u.length>0){h.error(u)}h.after()}}});return this},people:function(k,h,j){switch(arguments.length){case 1:if(jQuery.type(k)==="object"){h=k}else{if(jQuery.type(k)==="function"){j=k}}k=undefined;break;case 2:if(jQuery.type(k)==="string"&&jQuery.type(h)==="function"){j=h;h=undefined;break}if(jQuery.type(k)==="object"&&jQuery.type(h)==="function"){j=h;h=k;k=undefined;break}}h=h||{};if(h.url==undefined&&typeof L_Menu_BaseUrl=="undefined"){throw"Error 'people': not able to find the URL!"}h.url=h.url||(d.location.protocol+"//"+d.location.host+L_Menu_BaseUrl);j=j||(function(){});k=k||"";var g="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body><GetUserProfileByName xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService'><AccountName>"+k+"</AccountName></GetUserProfileByName></soap:Body></soap:Envelope>";var i=h.url+"_vti_bin/UserProfileService.asmx";jQuery.ajax({type:"POST",cache:false,url:i,data:g,beforeSend:function(l){l.setRequestHeader("SOAPAction","http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/GetUserProfileByName")},contentType:"text/xml; charset=utf-8",dataType:"xml",success:function(p){var q=[];p=p.getElementsByTagName("PropertyData");for(var n=0,l=p.length;n<l;n++){var m=p[n].getElementsByTagName("Name")[0].firstChild.nodeValue;var o=p[n].getElementsByTagName("Value");if(o&&o.length>=1){o=o[0].firstChild.nodeValue}else{o="No Value"}q.push(m);q[m]=o}j(q)},statusCode:{500:function(m){j([]);var l=m.responseXML.getElementsByTagName("faultstring");if(l.length==1){throw"Error 'people': "+l[0].firstChild.nodeValue}}}});return this},addressbook:function(k,h,j){switch(arguments.length){case 1:if(jQuery.type(k)==="object"){h=k}else{if(jQuery.type(k)==="function"){j=k}}k=undefined;break;case 2:if(jQuery.type(k)==="string"&&jQuery.type(h)==="function"){j=h;h=undefined;break}if(jQuery.type(k)==="object"&&jQuery.type(h)==="function"){j=h;h=k;k=undefined;break}}h=h||{};if(h.url==undefined&&typeof L_Menu_BaseUrl=="undefined"){throw"Error 'addressbook': not able to find the URL!"}h.url=h.url||(d.location.protocol+"//"+d.location.host+L_Menu_BaseUrl);h.limit=h.limit||10;h.type=h.type||"User";j=j||(function(){});k=k||"";var g="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body><SearchPrincipals xmlns='http://schemas.microsoft.com/sharepoint/soap/'><searchText>"+k+"</searchText><maxResults>"+h.limit+"</maxResults><principalType>"+h.type+"</principalType></SearchPrincipals></soap:Body></soap:Envelope>";var i=h.url+"_vti_bin/People.asmx";jQuery.ajax({type:"POST",cache:false,url:i,data:g,beforeSend:function(l){l.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/SearchPrincipals")},contentType:"text/xml; charset=utf-8",dataType:"xml",success:function(o){var s=[];o=o.getElementsByTagName("PrincipalInfo");for(var p=0,t=o.length;p<t;p++){var m=o[p].childNodes;s[p]=[];for(var n=0,q=m.length;n<q;n++){var l=m[n].nodeName;var r=m[n].firstChild;if(r){r=r.nodeValue}s[p].push(l);s[p][l]=r}}j(s)}});return this},reset:function(){this.data=[];this.length=0;this.listID=""},toDate:function(l){if(l.length!=19){return new Date()}var k=l.substring(0,4);var m=l.substring(5,7);var h=l.substring(8,10);var g=l.substring(11,13);var i=l.substring(14,16);var j=l.substring(17,19);return new Date(k,m-1,h,g,i,j)},toSPDate:function(k){var m=function(o){if(o.toString().length==1){o="0"+o}return o};var l=m(k.getMonth()+1);var h=m(k.getDate());var j=k.getFullYear();var g=m(k.getHours());var i=m(k.getMinutes());var n=m(k.getSeconds());return j+"-"+l+"-"+h+" "+g+":"+i+":"+n},toCurrency:function(h,o,k){h=Number(h);if(o==undefined){o=-1}if(k==undefined){k="$"}var l="";if(h<0){l="-";h*=-1}var t=h;if(o==-1){t=t.toFixed(2).replace(".00","")}else{t=t.toFixed(o)}var g=(Math.floor(h)+"").length;for(var q=0,p=0,r=g%3;q<g;q++){if(q==0||q%3!=r){continue}t=t.substr(0,q+p)+","+t.substr(q+p);p++}return(k!=""?k:"")+l+t+(k!=""?"":" "+k)},getLookup:function(h){var g=h.split(";#");return{id:g[0],value:g[1]}},toXSLString:function(l){var k=function(n,t){t=t||false;var o=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F");var x="";for(var q=0;q<n.length;q++){var u=n.charAt(q);var r=u.charCodeAt(0);var w=0;var v="";while(r>=16){w=r%16;r=Math.floor(r/16);v+=o[w]}v+=o[r];var s="";for(var p=v.length-1;p>=0;p--){s+=v.charAt(p)}x+="%"+s}return x};var g=l.split(" ");var h="";if(/[0-9]/.test(g[0])&&g[0].length<5){h=k(l.charAt(0));l=l.substring(1)}for(var j=0;j<l.length;j++){var m=l.charAt(j);if(/[0-9A-Za-z_]/.test(m)===false){h+=k(m).toLowerCase()}else{h+=m}}return h.replace(/%([a-zA-Z0-9][a-zA-Z0-9])/g,"_x00$1_").substring(0,32)},formfields:function(x,F){this.reset();if(arguments.length==1&&jQuery.type(x)==="object"){F=x;x=undefined}F=F||[];x=x||"";var n=[];if(jQuery.type(x)=="string"){x=(x==""?[]:x.split(","))}var j=function(I){if(I==undefined){var k=[];var H=(jQuery.type(r.values)=="array"?this.values:[this.values]);for(var t=0;t<H.length;t++){if(H[t]!==""){k.push(H[t])}}if(k.length==1){return k[0]}else{if(k.length==0){return""}else{return k}}}else{if(jQuery.type(I)=="string"||jQuery.type(I)=="boolean"){I=[I]}}if(jQuery.type(I)=="array"){for(t=0;t<this.elements.length;t++){if(this.elements[t].tagName.toLowerCase()=="option"){if(I.indexOf(jQuery(this.elements[t]).val())!=-1){this.elements[t].selected=true}else{this.elements[t].selected=false}}else{if(this.elements[t].tagName.toLowerCase()=="input"&&jQuery(this.elements[t]).attr("type")=="checkbox"){if(I[0]===true){this.elements[t].checked=true}else{if(I[0]===false){this.elements[t].checked=false}else{if(I.indexOf(jQuery(this.elements[t]).next().text())!=-1){this.elements[t].checked=true}else{this.elements[t].checked=false}}}}else{if(this.elements[t].tagName.toLowerCase()=="div"){jQuery(this.elements[t]).text(I.join("; ")).siblings("textarea.ms-input:first").val(I.join("; "))}else{jQuery(this.elements[t]).val(I.join(""))}}}}}return this};var l=function(){var k=[];for(var t=0;t<this.elements.length;t++){if(this.elements[t].tagName.toLowerCase()=="option"){k.push(jQuery(this.elements[t]).parent());break}k.push(this.elements[t])}switch(k.length){case 0:return null;case 1:return jQuery(k[0]);default:return jQuery(k)}};var o=function(){return this.tr};var u=function(){return this.type};var D=null;for(var G=document.getElementsByTagName("table"),A=0,B=G.length;A<B;A++){if(G[A].className.search("ms-formtable")!=-1){D=G[A];break}}if(D==null){throw ("Error: unable to find the table.ms-formtable!")}var q=function(i){var k=i[0];do{k=k.parentNode}while(k.tagName!="TR");return jQuery(k)};var C=function(L){var M=L[0].getElementsByTagName("td")[1].getElementsByTagName("span")[0];var K=[];var H=M.getElementsByTagName("input");for(var I=0;I<H.length;I++){var J=H[I].getAttribute("type");switch(J){case"text":if(H[I].className.search("ms-input")!=-1||H[I].className.search("ms-long")!=-1){K=[H[I]];I=H.length}break;case"radio":K=[H[I]];I=H.length;break;case"checkbox":K.push(H[I]);break}}if(K.length===0){var t=M.getElementsByTagName("select");for(I=0;I<t.length;I++){if(t[I].className.search("ms-RadioText")!=-1||(/_Lookup$|_SelectResult$/).test(t[I].id)){K=t[I].getElementsByTagName("option");break}}}if(K.length===0){var k=M.getElementsByTagName("div");for(I=0;I<k.length;I++){if(k[I].className.search("ms-inputuserfield")!=-1){K=[k[I]];break}}if(K.length===0){k=M.getElementsByTagName("textarea");for(I=0;I<k.length;I++){if(k[I].className.search("ms-long")!=-1){K=[k[I]];break}}}}return K};var E=(x.length>0?x.length:1000);if(F.mandatory||F.calendar||F.people){E=1000}for(G=D.getElementsByTagName("nobr"),A=-1,B=G.length,done=0;A<B&&done<E;A++){var z,v,p,w,s=false;var m;if(A==-1){if(E==0||x.indexOf("Content Type")!=-1){p="Content Type";s=true}}else{tr=undefined;z=jQuery(G[A]);p=z.html();w=z.text();if(p.search("ms-formvalidation")!=-1){p=p.slice(0,-39);if(p.charAt(p.length-2)=="<"&&(p.charAt(p.length-1)=="s"||p.charAt(p.length-1)=="S")){p=p.slice(0,-2)}if(F.mandatory==true){s=true}w=w.slice(0,-2)}if(!s){if(F.calendar){tr=q(z);s=(tr.find('input[id$="DateTimeFieldDate"]').length>0)}if(!s&&F.people){if(tr===undefined){tr=q(z)}s=(tr.find('img[title="Check Names"]').length>0)}}if(!s){tr=undefined;if(E==1000&&F.length==0){s=true}else{if(E!=1000){for(var y=0,h=E;y<h;y++){if(jQuery.trim(x[y])==w){s=true;done++;break}}}}}}if(s){var g=p;var r={name:g,elements:null,values:null,tr:null,type:null};if(g!="Content Type"){r.tr=(tr===undefined?q(z):tr);r.elements=C(r.tr)}else{r.elements=jQuery('[title="Content Type"]');r.tr=q(r.elements)}r.values=[];r.val=j;r.elem=l;r.getType=u;r.row=o;jQuery.each(r.elements,function(i,H){var J=jQuery(H);if(H.tagName.toLowerCase()=="input"&&J.attr("type")=="checkbox"){var I="";r.type="checkbox";if(/BooleanField$/.test(J.attr("id"))){I=H.checked;r.type="boolean"}else{if(H.checked==true){I=J.next().text()}}if(I!==""){r.values.push(I)}}else{if(H.tagName.toLowerCase()=="option"||H.tagName.toLowerCase()=="select"){var t=(H.tagName.toLowerCase()=="option"?J.parent():J);if(/_SelectResult$/.test(t.attr("id"))){t.find("option").each(function(){r.values.push(jQuery(this).text())});r.type="multiple"}else{var I=(/_Lookup$/.test(t.attr("id"))?t.find("option:selected").text():t.val());if(jQuery.type(I)=="array"){jQuery.each(I,function(K,L){if(L!=""&&L!=undefined){r.values.push(L)}});r.type="multiple"}else{if(I!=""&&I!=undefined){r.values.push(I)}r.type="select"}}return false}else{if(H.tagName.toLowerCase()=="div"){var I="";r.type="people";var k=J.closest("td.ms-formbody");I=((tmp=k.find("div#divEntityData").attr("key"))!=undefined?tmp:I);I=((tmp=k.find("input[id$='EntityKey']").val())!=undefined?tmp:I);if(I==""){I=J.text()}if(I==""){I=J.next().val()}I=(I==""?J.closest("span").children("input[id$='UserField_HiddenEntityDisplayText']").val():I);if(I!=""&&I!=null&&I!=undefined){r.values.push(I)}}else{if(H.tagName.toLowerCase()=="input"&&J.attr("type")=="radio"){r.type="radio";if(H.checked){r.values.push(J.next().text().replace(/^\s+/,"").replace(/\s+$/,""))}}else{r.type="text";if(/FieldDate$/.test(H.id)){r.type="date"}else{if(/UrlFieldUrl$/.test(H.id)){r.type="url"}}I=J.val();if(I!=""&&I!=undefined){r.values.push(I)}}}}}});if(r.type!="checkbox"&&r.type!="multiple"&&r.values.length==1){r.values=r.values[0]}else{if(r.values.length==0){r.values=""}}n.push(r)}}this.data=n;this.length=this.data.length;return this},val:function(l){if(l==undefined){var i=[];for(var h=0;h<this.data.length;h++){var j=this.data[h].val();if(jQuery.type(j)=="array"){jQuery.each(j,function(k,m){i.push(m)})}else{i.push(j)}}if(i.length==1){return i[0]}else{if(i.length==0){return""}else{return i}}}else{if(jQuery.type(l)=="string"||jQuery.type(l)=="boolean"||jQuery.type(l)=="number"){l=[l]}}if(jQuery.type(l)=="array"){for(var g=0;g<this.data.length;g++){this.data[g].val(l)}}return this},elem:function(){var g=[];for(var h=0;h<this.data.length;h++){jQuery.each(this.data[h].elem(),function(i,j){g.push(j)})}switch(g.length){case 0:return null;case 1:return jQuery(g[0]);default:return jQuery(g)}},row:function(){var g=[];for(var h=0;h<this.data.length;h++){jQuery.each(this.data[h].row(),function(i,j){g.push(j)})}switch(g.length){case 0:return null;case 1:return jQuery(g[0]);default:return jQuery(g)}},type:function(){var g=[];for(var h=0;h<this.data.length;h++){g.push(this.data[h].getType())}switch(g.length){case 0:return null;case 1:return g[0];default:return g}}};var c=(function(){var g=function(i){return new h(i)},h=function(i){this.mynode=i;return this};g.fn=h.prototype={getAttribute:function(i){return this.mynode.getAttribute("ows_"+i)}};return g})();e.del=e.remove;return d.$SP=d.SharepointPlus=e})(window);